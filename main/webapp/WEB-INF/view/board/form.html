<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main}">
	
	<main layout:fragment="content">
		
		<form id="frmRegist" name="frmRegist" method="post" th:action="@{/board/{action}(action=${mode})}" autocomplete="off" th:object="${boardDataDto}">
			<input type="hidden" name="gid" th:field="*{gid}">
			<input type="hidden" name="boardId" th:field="*{boardId}">
			<input type="hidden" name="id" th:if="${mode == 'update'}" th:field="*{id}">
			<div th:each="err : ${#fields.globalErrors()}" th:text="${err}" class="error"></div>
			<dl>
				<dt>작성자</dt>
				<dd>
					<input type="text" name="poster" th:field="*{poster}">
					<input type="password" th:if="${session.member == null && boardDataDto.member == null}" name="guestPw" placeholder=" 비회원 비밀번호"> 
					
					<div th:each="err : ${#fields.errors('poster')}" th:text="${err}" class="error"></div>
				</dd>
			</dl>
			<dl>
				<dt>제목</dt>
				<dd>
					<input type="text" name="subject" th:field="*{subject}">
					<div th:each="err : ${#fields.errors('subject')}" th:text="${err}" class="error"></div>
				</dd>
			</dl>
			<dl>
				<dt>내용</dt>
				<dd>
					<textarea id="content" name="content" th:field="*{content}"></textarea>
					<div th:each="err  : ${#fields.errors('content')}" th:text="${err}" class="error"></div>
					<button type="button" class='attach_file image'>이미지 첨부</button>
					<ul class='file_list' id="file_image_list">
						<li th:each="file : ${boardDataDto.attachedImages}">
							<a th:href="@{/file/download/{id}(id=${file.id})}" th:text="${file.fileName}"></a>
							<span class='remove' th:data-id="${file.id}">[x]</span>
						</li>
					</ul>
				</dd>
			</dl>
			<dl>
				<dt>파일첨부</dt>
				<dd>
					<button type="button" class="attach_file">파일 업로드</button>
					<ul class='file_list' id="file_list">
						<li th:each="file : ${boardDataDto.attachedFiles}">
							<a th:href="@{/file/download/{id}(id=${file.id})}" th:text="${file.fileName}"></a>
							<span class='remove' th:data-id="${file.id}">[x]</span>
						</li>
					</ul>
				</dd>
			</dl>
			<div class='btns'>
				<button type="submit" th:if="${mode == 'update'}" th:text="수정하기"></button>
				<button type="submit" th:unless="${mode == 'update'}" th:text="작성하기"></button>
				<button type="reset">다시쓰기</button>
			</div>
		</form>
		
		<script type="text/html" id="fileTpl">
			<li>
				<a href='../../file/download/<%=id%>'><%=fileName%></a>
				<span class='remove' data-id="<%=id%>">[x]</span>
			</li>
		</script>
	</main>
</html>



